version: '3.7'
services:
  ### ia: sensor connect
  # Reads sensor data and forwards it to the MQTT Broker
  sensorconnect:
    build:
      context: ./
      dockerfile: ./Dockerfile
    image: iaproduction.azurecr.io/ia-sensorconnect
    container_name: ia_sensorconnect
    restart: unless-stopped
    logging:
        driver: "json-file"
        options:
            max-file: "5"
            max-size: "10m"
    environment:
      - PYTHONUNBUFFERED=0
      - TRANSMITTERID=${CUBE_TRANSMITTERID}
      - BROKER_URL=${MQTT_BROKER_URL}
      - BROKER_PORT=${MQTT_BROKER_PORT}
      - IP_RANGE=${IOLINK_IP_RANGE}
    networks:
      - factory_cube
  
# Create a network for all containers
networks:
  factory_cube:
    name: factory_cube_network
    driver: bridge