# Copyright 2023 UMH Systems GmbH
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

---
{{if and .Values._000_commonConfig.infrastructure.mqtt.enabled .Values._000_commonConfig.infrastructure.mqtt.tls.useTLS }}

kind: Secret
apiVersion: v1
metadata:
  name: {{include "united-manufacturing-hub.fullname" .}}-databridge-mqtt-secrets
  labels:
    {{- include "united-manufacturing-hub.labels.common" . | nindent 4}}
    {{- include "united-manufacturing-hub.labels.databridge" . | nindent 4}}
type: Opaque
data:
  ca.crt: |
    {{- $ca := default .Values._000_commonConfig.infrastructure.mqtt.tls.caCert | nindent 4}}
    {{- if eq $ca "" }}
    LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tDQpNSUlGSkRDQ0F3eWdBd0lCQWdJRUNtMFVRekFOQmdrcWhraUc5dzBCQVF3RkFEQTZNVGd3TmdZRFZRUURFeTkxDQpibWwwWldRdGJXRnVkV1poWTNSMWNtbHVaeTFvZFdJdGFHbDJaVzF4WTJVdGJHOWpZV3d0YzJWeWRtbGpaVEFlDQpGdzB5TWpFeE1qZ3dPVEF5TlROYUZ3MHpNakV3TURZd09UQXlOVE5hTURveE9EQTJCZ05WQkFNVEwzVnVhWFJsDQpaQzF0WVc1MVptRmpkSFZ5YVc1bkxXaDFZaTFvYVhabGJYRmpaUzFzYjJOaGJDMXpaWEoyYVdObE1JSUNJakFODQpCZ2txaGtpRzl3MEJBUUVGQUFPQ0FnOEFNSUlDQ2dLQ0FnRUEzTXpSTnZuZ0lMM2ZIU3IxK1NaWGp6NjZjdGtQDQpESi9KOU9BK01abzBSeUpVVVVOcUdSRFo4Vk13UjN3ZE0yY1c4M25oZVkxU2JNaWJvMGx0TmZkZ1JwNDlqeGdTDQpPbzNXWjlPeC9qS2ZkOHE4M0tRVU1QR2wyNzE2REVWSXNVaVZ1SjloRisyZlp4VHlnLzB1eHR1TVQ2ZDE2ZXgwDQpEalBxTHlBZFZhcTJjdGJtWWs2Rkt1T2lWQkJsSWRkSzdGY1J0SE0wU09ONEcxNUcrR2o0bmVRYWhlc1F2cHNGDQpjKzNEQ3huYi8yUFR3U1ZGR2JOQ0c4ZkJhL3hTdjlDdUpxQmRPWStPYzRIR2xkT0cxenRWeUtMWW1JakpyYVJhDQo0Q29WTm1hQ2FIenUwVmsxb2RmVU83eXdRTjU0aS9nVlM0THVNbkRPaFFwOEdwV3BsZFdHc2hvNWdCaWs5UDVPDQptS0ZHK1UwSlp5aVpPRDF0QTQwOFlmUjl2YlJXc0Y1bC93bStQMElvVStQSVJPbWJVNHJzT3dER2cxSHg2U2NEDQo3TzR1UXRUZjhOQUMyR3ovV3JScmFkV0JQaW9QbkZhU29vT1Qva2xxVWhPKzJmNzZXakNNUlVqajd3cUlpOVJYDQpvNWtiTGJ5T2RpWFFxS1JTUW1TOFJpUTBuN1pVSG5OZjNRT2dCNzhGWmpxV2NFUG5LZHVDUlF6VmlHUG53Q0VlDQp6aXJFY3VxTllsaEkrMTF6RmdJL0RHUDJEVmsxem11TmxOT09uaU1HS2poSGR2dkR4QkZJakRsYWtYYUx0SENBDQowNVE1aThsb0F2dTgrc1pXVHJtL3NDRnBnWTV4R09VS3o3bDhxMG9vRVErUjlGclN0Tk15U0JyKytONnQvUktIDQpsdy9kYit0K1FKcjA5RThDQXdFQUFhTXlNREF3SFFZRFZSME9CQllFRlBkU29jZWFSaEpwOXNTOHhYOHJHWElTDQpVdzlmTUE4R0ExVWRFUVFJTUFhSEJIOEFBQUV3RFFZSktvWklodmNOQVFFTUJRQURnZ0lCQU5yMGloZDU0amxMDQpCTUo4S1NOQi9VdTJ2TUxuWlEyRzVOdENzMENwellnenZTOCsySFE0ZXlEeHF2aXJmVlQ1TGYxZnZ0OGVDVXR4DQpxbGdHdHZFVkN1TmVhbk1PdE9IZDFobVZISTNIMGQ2MXdheWtJNWpzZmlVYVVucmxkU1hIS2pOdUUrUjNEYmFnDQpLNVgrUnRpWlcvWUl3QU9sSzgzaTdUVEpqakhIc3o2S1BlbUUxdU8rb2hyOEtCTjgvbmJUdGIzb3RkTC84RmRCDQo3RlpQNmxFOG9BU0RGSm4rVFVQRUYwZkJ3Wnd1bDd1Mm1UV09hMEZWLzJyb3QvQytZam5CWUNEbEdCRlM4VDk0DQpLMG9EUFBMWXpwYjdLQW9QampCM1h3QXhDajJOV0tQYzhMam5YTVBZcm9KQmovMGFQTVNBNG5WVWt5am5MVjBoDQpXTXFZcHF2VTUyTGZhdHlMOFhIaVhERXA5TFVBMmxZNndaN2tRSjEycXVDNWx6aVA4Q0JJNkI3Tmt5MzlHYkFrDQo4bmI3bVJzUHQ1ZjFwWnJ3eEEra2svS0R5QWkzQ2l3L0NtL0oyOXBTVmErRnRrVkFsSzVSZkszdHc5eVg5MXlWDQpIcGc3VzlNZngwZVBKRzBObXFNQVJEbGlHMjdHY21vcDhMWHVaNms2N3RnNjNsNXR0V2FWd2JCLzhqR2szQXk3DQo3UTNoRDhtZEoxdlNLZm5ITDhpdW05U3VRZzdmR0Z1a3BldzViN281ZERhdGJmdEVLVEM4OVdUYmpHcDliWldSDQo1dkJIdzhrbjB5ampkSUdQMUFUeW05aUZIL3VSY3VrR3Z4bmc4UmZRZkVubmJ6MWF0S05wN3JMbFE5ZjdJOERyDQovUVgwVHVxbGJQdHdaKzdHQXc2amV0MGxzQnd5M0d2Kw0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQ0K
    {{- else }}
    {{- print $ca }}
    {{- end }}
  tls.crt: |
    {{- $tlscrt := default .Values._000_commonConfig.infrastructure.mqtt.tls.databridge.cert | nindent 4}}
    {{- if eq $tlscrt "" }}
    LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUZDekNDQXZPZ0F3SUJBZ0lVQlpNb09aRzlIMkFBZU1wemZ5Qm4rcGx5b3FVd0RRWUpLb1pJaHZjTkFRRUwKQlFBd0ZURVRNQkVHQTFVRUF3d0taR0YwWVdKeWFXUm5aVEFlRncweU16QTVNVGt4TkRBME1qWmFGdzB5TkRBNQpNVGd4TkRBME1qWmFNQlV4RXpBUkJnTlZCQU1NQ21SaGRHRmljbWxrWjJVd2dnSWlNQTBHQ1NxR1NJYjNEUUVCCkFRVUFBNElDRHdBd2dnSUtBb0lDQVFDKzVVbVB0S2dYVVdVQ0JhZk5MV2tHN0x5RTBxSXZIU0ZjOUUxSmxKUEgKTTVDVDB6c212ZU5vU2lNNGIybDZHS3BkKy9QdzNCK2dQN2x6aUwxV1EwZnZ5em5DTnp0eWlITHhoUExwS1pqdQpaV0hhWnBqUmdWMklkZjlKcmlMNUlWTld6S0ZWNEROeVpENHJRMVlKcjJ1a2wzTG1kNit0SjVRT1VmUDllYU5NCmFYd1FMNFVYak52VXF5VFIwbEJVMmF4R1ZMQTc3Qzk4Z0VtbjBNK21KQnd0Qm5ZamozZlduSTdhVGRxa0tFNE8KWTR5bmpKeUVEeldDVTFnU2dXWjd6bHVGSUhLTHVHWWpnMTgwTzh4djVlQ1RwYm11bXJGeDRocGVmOTRnSlV4bApkb3dHWG8vazdaR0RhRnI2UGkyaWJ6cVp0NzN6TmlCZ2xoMysyTFMxTkxYb1VZdmx6eXdUL0tuLzZmNExEMW0rCnVuQVo0d1lUUzhrN0JzeGdqMmR5dms5eXhOZFJkNGl3c3FtK2hQajlvamF2cHZweDdUcXdDd2E1c1g4SEFUYzEKWkprNlJ5cVJiRUtyeDdBYXpGeWc0cGZDQzM4aDR5NUI3MXNqc1dpU3hYUzdNZ2wyN1BiVWpoUmNDZlE5RHl5QwpVUGhtYnhQaTgyclVEMExCaTlrdFJQaVlEZDZ1QWwxb2N5N3dmeWRtSkc0cFNTRzhwRlJXR2J3dk1nSGorQ0hyCkM5WTRLZlkxL2kvWVIzMGEwd2NnMzF3ajkxbG91Mkw1VVkvVTBUNGUzN1Z0Ync0UkYxckwvRVp3UHlSZVRwM3cKUnBCUkNxREJ2Z2RRejR5NE91L3IzY2Z3R2Q5ZE1PNWl2Sm5vTTVnMktlYWNwVU5FRWMwYlJmWFdnMm9DWlBmMQpXd0lEQVFBQm8xTXdVVEFkQmdOVkhRNEVGZ1FVVkZ2MmgrMytTckIwcGNPa1Zyb0FLd2tiWmZ3d0h3WURWUjBqCkJCZ3dGb0FVVkZ2MmgrMytTckIwcGNPa1Zyb0FLd2tiWmZ3d0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBTkJna3EKaGtpRzl3MEJBUXNGQUFPQ0FnRUFEQUNlTStHY1lIWmYrWnBHNGxBUDVneHNLU24wNHhkVWlueE40WEVwalFTVwpEbyt2emJzcS95MVZUVzNzbXFGOTBINVpIUlBobVJSMjZOMUhjeWFQMGdLRWhCRzI4ZmZ6MWlWV096WGw3UjE3Ci9QMFc3Tngxdi81VEh6bFhPUFdEVE9HWkNOdzZpMnlNTlFjU21WS0RqL29DRmNjRlFtQXdFYTdXUUJ6NHZYcWsKcDRSV3NPTHpxS2x1Mk80OFRyVjV4ZlV2eHVZWmdVNDlNZVVGZzlHZnBEYU42cm8zeUYvdXFJaHUrT0FHUnpUUgpqVEtUTFVhdVBJT0w4YnM2MFlYWHVqbG9iSzI1R1VCUUFpaUZrbWxLTElpQUFTV2xJeHJHMERJRTUySHJlVFVPCllaWlE1VUxNNzdSVjlsdHpyaHFzaUd4dDhjd3RVQmFJUDk1Q05NMDhEUFBzRHI3L0VpS2Fib2o3TGtGSGMycFgKdkxpdC91STZUUHJGOTRnWkp3UER2QVg4T3RtMEVLVnRscGgzQk1MbXNiN0k3MHh6N0c2eEJSMC91Y3hHOE0rTgpEdW1JWEpBRFkrWE9RUE9vMkdjbzhza255ajNoTGlGWXRhNzNmOWhXMzdIWllQYzZCT0o5MUsveWxHTnhXRjB4CkpleVA0djRhTklvZVBKOTVVVGFVU1pPNVZHend0NTV4akgraitTbTF3SDhmckJvSkhFVHRabVJBY3R0US9zS2kKdUcwL3AvUDlOUEc4cG55dHd6NEFRSVEwYVNLTWtXZUhtNzB0U1pQM0hxMW41d1B2K3pqUUxjcStranlmNE5TMwp0UzJacEVNdUxIYzNQajhDL1FtNGhXM20xSlVGL3B6dlNZc0UrQVdxcW50aW5HSkN6c29wTUJISUwrQkhCVGc9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
    {{- else }}
    {{- print $tlscrt }}
    {{- end }}      
  tls.key: |
    {{- $tlskey := default .Values._000_commonConfig.infrastructure.mqtt.tls.databridge.key | nindent 4}}
    {{- if eq $tlskey "" }}
    LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUpRZ0lCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQ1N3d2dna29BZ0VBQW9JQ0FRQys1VW1QdEtnWFVXVUMKQmFmTkxXa0c3THlFMHFJdkhTRmM5RTFKbEpQSE01Q1QwenNtdmVOb1NpTTRiMmw2R0twZCsvUHczQitnUDdsegppTDFXUTBmdnl6bkNOenR5aUhMeGhQTHBLWmp1WldIYVpwalJnVjJJZGY5SnJpTDVJVk5XektGVjRETnlaRDRyClExWUpyMnVrbDNMbWQ2K3RKNVFPVWZQOWVhTk1hWHdRTDRVWGpOdlVxeVRSMGxCVTJheEdWTEE3N0M5OGdFbW4KME0rbUpCd3RCbllqajNmV25JN2FUZHFrS0U0T1k0eW5qSnlFRHpXQ1UxZ1NnV1o3emx1RklIS0x1R1lqZzE4MApPOHh2NWVDVHBibXVtckZ4NGhwZWY5NGdKVXhsZG93R1hvL2s3WkdEYUZyNlBpMmlienFadDczek5pQmdsaDMrCjJMUzFOTFhvVVl2bHp5d1QvS24vNmY0TEQxbSt1bkFaNHdZVFM4azdCc3hnajJkeXZrOXl4TmRSZDRpd3NxbSsKaFBqOW9qYXZwdnB4N1Rxd0N3YTVzWDhIQVRjMVpKazZSeXFSYkVLcng3QWF6RnlnNHBmQ0MzOGg0eTVCNzFzagpzV2lTeFhTN01nbDI3UGJVamhSY0NmUTlEeXlDVVBobWJ4UGk4MnJVRDBMQmk5a3RSUGlZRGQ2dUFsMW9jeTd3CmZ5ZG1KRzRwU1NHOHBGUldHYnd2TWdIaitDSHJDOVk0S2ZZMS9pL1lSMzBhMHdjZzMxd2o5MWxvdTJMNVVZL1UKMFQ0ZTM3VnRidzRSRjFyTC9FWndQeVJlVHAzd1JwQlJDcURCdmdkUXo0eTRPdS9yM2Nmd0dkOWRNTzVpdkpubwpNNWcyS2VhY3BVTkVFYzBiUmZYV2cyb0NaUGYxV3dJREFRQUJBb0lDQUNuSE5wVTczWG5VOTMwOHpaK3E2NHgzCmJUN0lkblJITk5FS0tvd0s5MWltWVdMbzNNNDZ5clU5WEgzeWJDd3JqOFduNlpoeUpIM0cxSWlEaWFTQ2J4RDgKOGpRZU1HVjlsV0prVFdGWUdEODhjdkVBZVR1SXkzYWRGSFVFcG1UTnRWYU96RlJtRC94ZUVma1g4SkdJRWMvZwowV1c5RmZhWWJkL0FjZHlzclYrQXlvVWtVVVY1TDNkWXlXTWVXelJtdXp4ZE5vQzJ6U0c3VmVOallMNmtzb0hzCkl4amZRa1AyMlpEUGJ5VjBLTGtmY2w0TStRZ3g1KzBRM25xV1ZWNk5LQngzb0hvUnJsRGhaSW1pK0xnWW9GRFAKK1ZaTVJyOTgwM2FSRjRVRGhMZkQvUnM3d05SQ1poRlRXbTNnQTg3RDl4aERUVkFZTFhmV0F0U09pdVlKbGpIVAo1TENZajFtSU8vSmEzY3lialZHczRVajBSekpaUGdweXZtckRwZ0JsRG1Jb1FsYWpoeXc4NzRDNEo0c21ZSHV1CmYvWTZBOWdpclpDWHJEdGgxWDBxeXRmMy9rcGhOQm5mOTM2Uml1SDlmeFVaVlZNUzVEL1pEdGhQZCtZQXJMRTUKN3M3MkhwRFIrakFsUUVqbS94MTN4aGZlK3dFUncwQXZSbXlTMER2S1BEM0J1SnU5R04yK2xyK0daNnU5d2h0dApUVU8rVHdmVlRNdHQ1SmlBbU9XRTByaUlLbzJvcnIrcHBmOFRabWFUMVhxYWlWTFk2dEo4dzlkM3VTVXY2NzlnCk4yRHJhTW1wTHpUaERrekxzVWtHeXo1VWpiREpRbUhoVUdscVAxM1dudkNza2N6QWp0ZCtsNXdWei9VZE4rSUIKTXZoeVdrM2tmLzYva2ZFR0dnMTVBb0lCQVFETFNuTmlzUmZxU0FITVAwd2dseTdLM1pwOTVuSnRaYStqUU1aQwoyazFmOHVyNFU0K21WM3VzQURNalMzR29VNENHRGhxUGhaNXRTUzk2SERVc0NpY1dCSzZrNkRpZ29RbmpXVGFPCmVENnA3NlAxcjBQQWFRL3I1Mm5TSC91WS9ZUXJzQ3BmMWFMM2VUdHZES2lRbUhxNTNSSEExQ3UwWWhkMDJoZmoKNlBSdUY5b3hxVy8zdmp5cDU0cGJxdnZsWTkwL0xPUzFnbHZLOTl2bGx2dFkxZWxTR1V1WFVNREtRdmFteGVEaQpsR1BYMlBSRWx2L21OY09IcXhqdGU2OXB3a1RwMGdjbFVrMDZ1cDRicWhoemJ6MjFJUkpZZ0NvbzN6SWNORDhLCjlvdnlzNWhWRjBoTjJpcEl1TEk5QlI2eCtJM0RmTHo4N1hTOW1pRTNqR0gxSzJwSEFvSUJBUUR3WkJtUjM3T2gKNlVxQ3c3TUE3bGNqZWVmTVd5MXEwRFlUdytmTHRTM2htdHAyR2dISnptdVdORGNOeVIzKzJ4a0R3K2JRZEIyZQpiSW4yVk9XYmk3VEJvWXNaN2FHdCtmK2hkR3ZSV1FnUDZFN0VydTRiTnZLekdwb3ZocitKWDBndkQzclZZM2RMCmFROXg1aXJUcEw3T2JVZDlSbWgzcVZaN29KV2t5RnNRZE5TSFFzTmtjUzJ3R3BSZEFnc285dVI1bXBWTFl0NW4KbWNlUm1RRU5wWWhLTXVucVdoclprYjI2UHJ5TUJrR011MnM5aUVDaVBqcjBSeE1hMkw5ZDhlTEFhQXozTWxTaQpYZ25iVURCZDV5RmVwcVRxMldnU0xwUWM2ZkZpZ2NWVlVUZjBKSkQvcE1xMmVHa2I5MTJPWFkyajE0YVRkWW1JClRvT0dYRTNqRUJKTkFvSUJBRUdWZ0VvcnBmS0FUb3d0TTRza0d3VjVucmpWV3I4dVdnNkovQ3hmTHkwd09sdm8KNFdRaHZ4VkxielFJeDk4dEtUNldXRDFMTjBROG95TjY3RENNQ2ZZUmhxSlBCTTNWaGxJaFd2ZDFsWW5QZFE3eQoveUdaQTNqd3pIUHN1NGVzNmpJS0FIR3dnNFhoUjZwWTVCemFCR1hvQ3kweGhmUUkzVlptY2VTbUtBMUlocTBVCjQ3bUNWeUhkUUFhNHo5RStlWWRESFhudFYxM1F2dEYvOXhDKzJpb1JYUkN4RGJGekR3M1lzdWVHUmZ2QjAzUTUKWHM5UE13aVd5MUQ2WVNuMmNiTVpmaEt0VFpzUHo2aFBKTnBBM2lDTVRkWGRhenlLWFNrNk5jaDhwOE9oNnhndwpqYlFJR1RJaTIrWFJ2QWhnanFPdG4yN2QwSmJHbmNiRTlHbGJHMHNDZ2dFQU5qNGdGdTVuVmkyU0JwZXFHSmV2ClNlNEVBL1MrOXM4c3BLRWIrTGRWTndiK0xKQUp2ME80dXhmbEpGTXhWWVNTekdxejltMTlFWFprV3hVbENrZ24KN1ZsS1RmdDA5QkRwUWNGSFl1RzRFLzdUWjBZaHJEcGw0VXdyWm5YOVdqNEp4N1N5ZnR3RzJ4bEZ4dW1zMkR6ZwpZU3YvYWFFdGlYTElkUFR6VDA5MlhPdy8ySldVQ1dJUWNTQk9RZjVvRGtKSG83amgzelRjQW55TXI2bmF0djJYCkYwY055VGV6djB4SGgzTUlrSUFJNG55WDRqYVFmd3VUdWZNZnVIc1lFMWExVjcwaXo5U25qRXV6NWF6ZWZSSGUKVWNGQWpVMnBVaEQ0a3QybS9oZFNNOEl6NGY4dVNNRWlqTEgyNWJ5WGU3eFliWlFBWmQycnZ2b1lhNFVBZmkvdQpNUUtDQVFFQXdIVlJKM0ZxcnI3ZytPL2dORWdRNU01TVUyT0NzQ2g0SXBLSGxvUHdYOE9OS09WdC9GNzNTUEwvCnlKVy9PSFpNemsrcmVldi90eWNqYVkxRU5YWmxGRjdCQzJGd2tndGpMWGVPNlFmRTRwaE93a2NUdzJGamE4MW8KQ2o0K2J2UWcydTJEREM2dDcxc2FvZjhib0ZzR2RsdjRuaHNTT2pwd2tYalhuL2Q4NHZIVU9MRXdSOXlKeEtKSwpHRjJqUFJrZDFLWGoybkUyRWNoM21iN1FPWnV3bmN2Q1lEalVkZkFZWTlvVm0wQWhuc0M3N1RFdHFsTlc3RmFFCjNFL1pOOVNtWS91TGJ0a215MFpxdm1LdC9oTnhVTnYxYmNpU1RzWk1xeGEzcDdYVjdIZ25ZSWN4aDQ1TmdiM0cKdHJnTU5kUnk1SjVyZFpSNHNKY0N0QWF4czdFWXJBPT0KLS0tLS1FTkQgUFJJVkFURSBLRVktLS0tLQo=
    {{- else }}
    {{- print $tlskey }}
    {{- end }}

{{end}}
